#!/bin/sh

set -e

if [ "$#" -ne 1 ]; then
  echo "Usage $0 <model dir>"
  exit 1
fi

MODELDIR=$(cd $1; pwd)
IMAGE=${IMAGE:-hiroara/tensorflow-model-server:${TAG:-latest}}
PORT=8500

CONTAINER=$(docker run -it -d --rm -p ${PORT} -v ${MODELDIR}:/models ${IMAGE} tensorflow_model_server --enable_batching --model_base_path=/models)
HOSTPORT=$(docker port ${CONTAINER} ${PORT})
echo ${CONTAINER} ${HOSTPORT}
